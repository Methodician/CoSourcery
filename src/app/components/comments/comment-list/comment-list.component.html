<!-- New Comment Entry -->
<section *ngIf="loggedInUser.uid"
  class="comment-controls">
  <button *ngIf="!addingNewComment"
          (click)="enterNewCommentMode()">
    {{ isUnderComment ? 'Reply' : 'Comment' }}
  </button>
  <button *ngIf="addingNewComment"
          (click)="onCancelNewComment()">
    Cancel
  </button>
  <button *ngIf="addingNewComment"
          (click)="onAddComment()">
    Save
  </button>
</section>

<cos-comment *ngIf="addingNewComment"
             [isBeingEdited]="true"
             [loggedInUser]="loggedInUser"
             [authorInfo]="loggedInUser"
             (textChanges)="onEditText($event)">
</cos-comment>

<!-- Comment List -->
<section *ngFor="let comment of comments | reverseArray"
         class="comment-list">
  <section *ngIf="loggedInUser.uid === comment.payload.val().authorId"
            class="comment-controls">
    <button *ngIf="!commentIsBeingEdited(comment)"
            (click)="enterEditMode(comment)">
      Edit
    </button>
    <button *ngIf="commentIsBeingEdited(comment)"
            (click)="onCancelEdit()">
      Cancel
    </button>
    <button *ngIf="!commentIsBeingEdited(comment)"
            (click)="onRemoveComment(comment)">
      Remove
    </button>
    <button *ngIf="commentIsBeingEdited(comment)"
            (click)="onSaveEdits(comment)">
      Save
    </button>
  </section>
  <cos-comment [commentSnapshot]="comment"
               [loggedInUser]="loggedInUser"
               [isBeingEdited]="commentIsBeingEdited(comment)"
               (textChanges)="onEditText($event)">
  </cos-comment>
  <cos-comment-list [parentKey]="comment.key"
                    [loggedInUser]="loggedInUser">
  </cos-comment-list>
</section>
