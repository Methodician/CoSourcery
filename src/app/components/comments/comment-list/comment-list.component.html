<!-- New Comment Entry -->
<section class="comment-controls">
  <button *ngIf="!addingNewComment"
          (click)="enterNewCommentMode()">
    {{ isUnderComment ? 'Reply' : 'Comment' }}
  </button>
  <button *ngIf="addingNewComment"
          (click)="onCancelNewComment()">
    Cancel
  </button>
  <button *ngIf="addingNewComment"
          (click)="onAddComment()">
    Save
  </button>
</section>

<cos-comment *ngIf="addingNewComment"
             [isBeingEdited]="true"
             [loggedInUser]="loggedInUser"
             [authorInfo]="loggedInUser"
             [comment]="newCommentStub">
</cos-comment>

<!-- Comment List -->
<section *ngFor="let key of commentKeys | reverseArray"
         class="comment-list">
  <section *ngIf="loggedInUser.uid === commentMap[key].authorId"
            class="comment-controls">
    <button *ngIf="!commentIsBeingEdited(key)"
            (click)="enterEditMode(key)">
      Edit
    </button>
    <button *ngIf="commentIsBeingEdited(key)"
            (click)="onCancelEdit()">
      Cancel
    </button>
    <button *ngIf="!commentIsBeingEdited(key)"
            (click)="onRemoveComment(key)">
      Remove
    </button>
    <button *ngIf="commentIsBeingEdited(key)"
            (click)="onSaveEdits(key)">
      Save
    </button>
  </section>
  <cos-comment [comment]="commentMap[key]"
               [loggedInUser]="loggedInUser"
               [authorInfo]="userMap[commentMap[key].authorId]"
               [isBeingEdited]="commentIsBeingEdited(key)">
  </cos-comment>
  <cos-comment-list [parentKey]="key"
                    [loggedInUser]="loggedInUser">
  </cos-comment-list>
</section>
