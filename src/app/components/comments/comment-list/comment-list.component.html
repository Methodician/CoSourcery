<!-- New Comment Entry -->
<!-- Let's still show this and offer to redirect to login/register if they are not -->
<section style="margin: 30px;"
  *ngIf="loggedInUser.uid"
  class="comment-controls">
  <button *ngIf="!addingNewComment"
    (click)="enterNewCommentMode()">
    {{ isUnderComment ? 'Reply' : 'Comment' }}
  </button>
  <button *ngIf="addingNewComment"
    (click)="onCancelNewComment()">
    Cancel
  </button>
  <button *ngIf="addingNewComment"
    (click)="onAddComment()">
    Save
  </button>
</section>

<cos-comment style="margin: 30px;"
  *ngIf="addingNewComment"
  [isBeingEdited]="true"
  [loggedInUser]="loggedInUser"
  [authorInfo]="loggedInUser"
  [comment]="newCommentStub">
</cos-comment>

<!-- Comment List -->
<section *ngFor="let key of commentKeys | reverseArray"
  class="comment-list"
  style="margin: 30px;">
  <section *ngIf="loggedInUser.uid === commentMap[key].authorId"
    class="comment-controls">
    <button id="comment-edit-btn" *ngIf="!commentIsBeingEdited(key)"
      (click)="enterEditMode(key)">
      Edit
    </button>
    <button id="comment-edit-btn" *ngIf="commentIsBeingEdited(key)"
      (click)="onCancelEdit()">
      Cancel
    </button>
    <button id="comment-remove-btn" *ngIf="!commentIsBeingEdited(key) && loggedInUser.uid === commentMap[key].authorId"
      (click)="onRemoveComment(key)">
      Remove
    </button>
    <button id="comment-save-btn" *ngIf="commentIsBeingEdited(key)"
      (click)="onSaveEdits(key)">
      Save
    </button>
  </section>
  <cos-comment [comment]="commentMap[key]"
    [loggedInUser]="loggedInUser"
    [authorInfo]="userMap[commentMap[key].authorId]"
    [isBeingEdited]="commentIsBeingEdited(key)">
  </cos-comment>
  <cos-comment-list [parentKey]="key"
    [loggedInUser]="loggedInUser">
  </cos-comment-list>
</section>

<!-- <div *ngFor="let key of commentKeys | reverseArray"
  style="margin: 30px;">
  <cos-comment [comment]="commentMap[key]"
    [loggedInUser]="loggedInUser"
    [authorInfo]="userMap[commentMap[key].authorId]"
    [isBeingEdited]="commentIsBeingEdited(key)"></cos-comment>
  <div style="margin-left: 30px;">
    <button (click)="enterEditMode(key)"
      *ngIf="!commentIsBeingEdited(key)">edit</button>
    <button (click)="onCancelEdit()"
      *ngIf="commentIsBeingEdited(key)">cancel</button>
    <button (click)="onRemoveComment(key)"
      *ngIf="!commentIsBeingEdited(key)"
      style="margin-left: 30px;">remove</button>
    <button (click)="onSaveEdits()"
      *ngIf="commentIsBeingEdited(key)"
      style="margin-left: 30px;">save</button>
  </div>

  <cos-comment-list [parentKey]="key"
    [loggedInUser]="loggedInUser"></cos-comment-list>
</div> -->
