<form *ngIf="loggedInUserId"
      [formGroup]="profileForm"
      class="profile-form">

  <h2 class="profile-form__title">Profile</h2>

  <section class="profile-card">
    <div class="profile-card__input-group">
      <section class="profile-image">
        <img class="profile-image__src"
             [src]="profileForm.value.imageUrl ? profileForm.value.imageUrl : '../../assets/images/logo.png'"
             alt="Profile Image">
        <input class="profile-image__input"
               accept="image/*"
               type="file"
               (change)="onSelectProfileImage($event)">
        <div *ngIf="uploadTracker">upload%: {{ imageUploadPercent$ | async }}</div>
      </section>

      <div>
        <mat-form-field class="profile-card__input" [floatLabel]="'always'">
          <mat-label>First Name</mat-label>
          <input #firstName matInput
                 type="text"
                 formControlName="fName"
                 maxlength="30"
                 (blur)="trimInput('fName')"
                 required/>
          <mat-error>Please provide your first name.</mat-error>
          <mat-hint align="end">{{firstName.value.length}} / 30</mat-hint>
        </mat-form-field>

        <mat-form-field class="profile-card__input" [floatLabel]="'always'">
          <mat-label>Last Name</mat-label>
          <input #lastName matInput
                 type="text"
                 formControlName="lName"
                 maxlength="30"
                 (blur)="trimInput('lName')"
                 required/>
          <mat-error>Please provide your last name.</mat-error>
          <mat-hint align="end">{{lastName.value.length}} / 30</mat-hint>
        </mat-form-field>

        <mat-form-field class="profile-card__input" [floatLabel]="'always'">
          <mat-label>Alias</mat-label>
          <input #alias matInput
                 type="text"
                 formControlName="alias"
                 maxlength="30"
                 (blur)="trimInput('alias')"/>
          <mat-hint>Alternate display name.</mat-hint>
          <mat-hint align="end">{{alias?.value.length}} / 30</mat-hint>
        </mat-form-field>
      </div>
    </div>

    <mat-form-field class="profile-card__input" [floatLabel]="'always'">
      <mat-label>Bio</mat-label>
      <textarea matInput
                type="text"
                formControlName="bio"
                placeholder="Say something about yourself ..."
                rows="5"
                maxlength="500"
                (blur)="trimInput('bio')">
      </textarea>
      <mat-hint align="end">{{bio?.value.length}} / 500</mat-hint>
    </mat-form-field>

    <div class="profile-card__input-group">
      <mat-form-field class="profile-card__input" [floatLabel]="'always'">
        <mat-label>Email</mat-label>
        <input matInput
               type="email"
               formControlName="email"
               maxlength="50"
               (blur)="trimInput('email')"
               required/>
        <mat-error>Please provide a valid email address.</mat-error>
      </mat-form-field>

      <mat-form-field class="profile-card__input" [floatLabel]="'always'">
        <mat-label>City</mat-label>
        <input matInput
               type="text"
               formControlName="city"
               maxlength="30"
               (blur)="trimInput('city')"/>
      </mat-form-field>
    </div>

    <div class="profile-card__input-group">
      <mat-form-field class="profile-card__input" [floatLabel]="'always'">
        <mat-label>State</mat-label>
        <input matInput
               type="text"
               formControlName="state"
               maxlength="2"
               (blur)="trimInput('state')"/>
      </mat-form-field>

      <mat-form-field class="profile-card__input" [floatLabel]="'always'">
        <mat-label>Zip Code</mat-label>
        <input matInput
               type="text"
               formControlName="zipCode"
               maxlength="5"
               (blur)="trimInput('zipCode')"/>
      </mat-form-field>
    </div>

    <button class="cos-btn"
            type="button"
            [disabled]="!profileForm.valid || profileForm.pristine"
            (click)="onSaveProfileChanges()">
      Update
    </button>
  </section>
</form>
